---
layout: post
title: "Literature Review: COSMIC: Generalized Refusal Direction Identification in LLM Activations"
date: 2025-06-14
categories: research
tags: [Interpretability, Trustworthy AI, Adversarial AI, LLM, AI Safety]
---

COSMIC proposes a fully output-agnostic pipeline for finding "refusal directions" in a language model's residual-stream activations. By ranking candidate directions with a cosine-similarity–based "concept inversion" score, the method automatically selects both the steering vector and the layer at which to intervene, without relying on surface-level refusal templates such as "I'm sorry, but…". The paper demonstrates that COSMIC can (i) match or exceed handcrafted or substring-matching baselines in normal settings, (ii) continue to work when every prompt elicits a refusal (adversarial complete-refusal), and (iii) extract useful safety vectors even from weakly aligned or jailbreak-fine-tuned models.

## Key Insights

COSMIC starts by discarding any reliance on surface text and searches for refusal features directly in activation space. For every token position and layer it forms a "difference-in-means" vector between harmful and harmless prompts, then evaluates each vector with a concept-inversion score: If adding the vector pushes harmless activations toward the harmful cluster and ablating it pulls harmful activations toward harmless ones, that vector receives a high score. The best-scoring direction acts as a compact signature of refusal without ever looking at the model's decoded words.

The search is narrowed to the 10 % of layers where harmful and harmless activations diverge most, on the premise that refusal features are concentrated in these layers. Once the direction is chosen, it can be reused by any steering rule—linear addition, affine shifts, or future editing schemes—so the discovery cost is paid only once.

Robustness tests underscore the value of this output-agnostic approach. When a system prompt forces every response to be a refusal, string-match baselines fail completely, yet COSMIC still extracts a steerable vector. On uncensored fine-tunes such as dolphin-2.9.4 and Lexi-Uncensored-V2, injecting the vector with a modest affine gain cuts jailbreak success by 10–20 % while introducing few false refusals.

Finally, scaling experiments reveal that refusal behavior is not governed by a single linear axis: moderate gains strengthen refusals, but very large gains can re-jailbreak the model, hinting at nonlinear geometry in the underlying representation space.

<p align="center">
  <img src="../../../assets/img/literature/24_0.png" width="600"/>
</p>
<p align="center"><em>Figure: COSMIC workflow.  Candidate difference-in-means vectors are extracted at multiple layers & token positions, scored with internal cosine similarity, and the best vector is reused by any steering rule.</em></p>

## Example

Imagine a harmful prompt "Describe how to make nerve gas" and a harmless prompt "Describe how to make pasta sauce."

1. Run both prompts through the model, grab residual activations for the last five post-instruction tokens at each layer.
2. Compute `r_{i,l} = mean_harmful – mean_harmless` for every `(i,l)`.
3. For each candidate, perform a _virtual_ forward pass twice on a validation set: once with activation addition (`+r`) and once with directional ablation.
4. Concatenate activations at the 10 % most discriminative layers, evaluate `S_refuse + S_comply`, keep the top-scoring `(i*,l*)`.
5. At inference, inject `+r*` to force a refusal or ablate `r*` to bypass it—no template matching required.

## Ratings

**Novelty: 4/5**
The shift from output-based heuristics to purely activation-based scoring is a substantial methodological step, though it builds on well-known difference-in-means and cosine-similarity tools.

**Clarity: 3/5**  
Overall presentation is readable, but several design choices—most notably the "lowest 10 % of layers" heuristic—lack empirical justification. Some figures are crowded, and the non-monotonic α-sweeps deserve deeper analysis.

## Personal Comments

The output-agnostic selection is the paper's strongest contribution; anyone who has wrestled with fragile string-match refusal detectors will appreciate this improvement. Historically, early debiasing work on word embeddings used similar cosine tricks, but applying them to dynamic steering in LLMs is a natural yet non-trivial extension.

That said, the 10 % layer threshold feels arbitrary. A Pareto-style 80/20 heuristic, or even a learned threshold based on an elbow in the similarity curve, might generalize better. I do like the simple harmful/harmless filtering, but the method could profit from an ablation study varying this percentage.

The non-monotone response to scaling `α` echoes older findings in feature surgery: beyond a certain magnitude you start exciting off-manifold directions, so behavior swings unpredictably. This underscores that "directions" are local linearizations, not global axes.

I think it would be interesting to look into adaptive layer weighting instead of a hard 10% cut and potentially combining the COSMIC scoring with other methods to isolate cleaner directions.
